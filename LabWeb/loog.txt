SELECT user.uid uid,user.name name,user.kind kind,MAX(latesttime.submittime) latest,COUNT(twoweeksum.id) twoweek,COUNT(onemonthsum.id) onemonth FROM lab_user user LEFT JOIN lab_report latesttime ON user.uid = latesttime.uid LEFT JOIN lab_report twoweeksum ON user.uid = twoweeksum.uid AND twoweeksum.submittime > '2014-07-23 12:36:37' LEFT JOIN lab_report onemonthsum ON user.uid = onemonthsum.uid AND onemonthsum.submittime > '2014-07-06 12:36:37'  WHERE (  user.uid LIKE '%%' OR user.name LIKE '%%' ) AND user.graduate = 61 GROUP BY uid ORDER BY `kind` desc LIMIT 0,50  